



# SmarToDo 需求分析

## 1. 介绍

本项目旨在开发一款集任务管理、进度追踪、用户动态与 AI 辅助于一体的现代化待办事项应用。系统不仅支持传统的清单分组管理和无限层级子任务，还引入了“动态（Activity Stream）”功能以记录用户操作历史，并通过 AI Agent 实现自然语言交互，降低用户创建和拆解任务的门槛。

### 1.1 核心实体关系

系统基于如下**四个核心实体**建构：

1. **清单分组（List Group）**：顶层分类
2. **清单（List）**：归属于清单分组
3. **任务分组（Task Group）**：分类清单内部的任务
4. **任务（Task）**：归属任务分组，理论支持**无限子任务**

## 2. 界面布局与交互逻辑 (UI/UX)

### 2.1 全局侧边栏 (Sidebar)

- **结构**：

  ```
  全部任务                                   |
  动态                                       | 
  ------------------------------------------ |
  - 默认清单分组 (System Default List Group)- |
    - |- 默认清单 (Inbox)                    |           主 工 作 区
    - |- 其他用户自建清单                     |     
  - 自建清单分组 (User List Groups)           |
    - |- 清单 A                              |
    - |- 清单 B                              |
  ```

- **交互**：支持对清单分组、清单的增删改查，支持清单在不同分组间拖动。

### 2.2 主工作区逻辑

- **全部任务**：
  - 显示所有 `Task`。
  - 新建任务时，默认归入：`默认清单分组` -> `默认清单` -> `默认任务分组`。
- **单个清单详情**：
  - 顶部展示清单名称。
  - 主体区域展示该清单下的所有 `Task Group` (任务分组)。
  - 用户可以创建新的 `Task Group` 来对任务进行分类管理。
- **AI Agent**：
  - 接收自然语言，解析后自动创建结构化数据。
  - 例如：“在‘工作’清单的‘待处理’分组下创建一个任务”，AI 需解析出 List 和 Task Group 的 ID。

## 3. 详细功能需求

### 3.1 侧边栏与导航模块 (Sidebar)

**功能描述**： 侧边栏是系统的骨架，支持收缩/展开，展示系统的层级结构。

**详细需求**：

1. **固定入口**：
   - **全部任务**：点击进入全局任务视图。
   - **动态**：点击进入全局动态视图。
2. **清单分组管理**：
   - **默认清单分组**：系统内置，不可删除。包含“默认清单”（即 Inbox/收集箱）。
   - **自建清单分组**：用户可创建新的分组（如“工作”、“生活”）。支持重命名、删除。
3. **清单管理**：
   - 在分组下创建新清单。
   - 支持拖拽清单在不同分组间移动（进阶需求）。
   - 清单右键菜单：重命名、删除、设置颜色图标。
4. **收缩交互**：侧边栏收起时，仅显示图标，悬浮显示名称。

### 3.2 全部任务视图 (All Tasks Dashboard)

**功能描述**： 默认的着陆页，汇总显示所有清单下的任务。

**主区域布局**：

1. **顶部 Header**：
   - 标题：“全部任务”。
   - **快捷新建下拉框**：
     - *新建任务*：默认归入“默认清单”的“默认分组”。
     - *新建清单*：默认归入“默认清单分组”。
2. **工具栏 (Toolbar)**：
   - **筛选**：状态（已完成/未完成/已过期）、优先级。
   - **排序**：创建时间（默认）、开始时间、截止日期、优先级。
   - **视图控制**：是否平铺展示子任务（Switch 开关）。
3. **任务列表区**：
   - 展示所有任务卡片/列表项。
   - 显示任务所属的清单名称（因为是汇总视图，需标明来源）。

### 3.3 单个清单视图 (Single List View)

**功能描述**： 点击侧边栏具体清单进入的视图。

**主区域布局**：

1. **顶部 Header**：
   - 清单名称、图标、更多设置（···）。
2. **Tab 切换**：
   - **[列表] (默认)**：任务管理界面。
   - **[动态]**：仅筛选显示该清单下的操作记录。
3. **任务分组 (Bucket) 管理**：
   - 清单内部支持“任务分组”（类似看板的列，但以垂直列表形式存在）。
   - 默认存在“默认分组”。
   - 支持“新建分组”、“重命名分组”、“拖拽排序分组”。
4. **任务列表**：
   - 在各分组下渲染任务。
   - 支持组内新建任务。

### 3.4 任务对象与无限层级 (Task Object)

**核心逻辑**： 任务采用**递归结构**设计。

**属性定义**：

- **基础**：标题、描述、状态（Done/Todo）、优先级。
- **时间**：创建时间、开始时间、截止时间、完成时间。
- **归属**：所属清单 ID、所属任务分组 ID、父任务 ID (Parent_ID)。

**交互需求**：

1. **层级展示**：
   - 列表视图中，子任务默认缩进显示，或点击父任务展开折叠。
   - 支持无限层级（建议前端限制渲染深度，如最多显示 5 层，更深层级需进入详情页）。
2. **详情弹窗/侧滑页**：
   - 点击任务弹出详情。
   - 在详情页中可直接添加子任务。
   - 显示该任务的专属动态（创建、修改、完成记录）。

### 3.5 动态系统 (Activity Stream)

**功能描述**： 记录并展示用户对系统数据的增删改操作，形成时间轴。

**数据结构与展示**：

1. **全局动态**：侧边栏“动态”入口，显示所有清单的操作。
2. **清单动态**：清单页 Tab，仅显示该清单相关操作。
3. **展示格式**：
   - **时间轴设计**：按日期分组（今天、昨天、周六 09-02 等）。
   - **条目布局**：
     - *左侧*：具体时间 (HH:mm)。
     - *中间*：用户头像 + 操作描述（富文本，高亮对象）。
       - 格式：`[用户] [动词(创建/完成/删除)] 了 [对象类型] “[对象名称]”`
       - 例如：`Admin 完成 了 任务 “编写需求文档”`
     - *右侧*：所属上下文（清单名/分组名）。
4. **分页加载**：
   - 采用滚动到底部自动加载 (Infinite Scroll)。
   - 后端接口需支持 `cursor` (基于时间戳) 或 `page` 分页。

### 3.6 AI Agent 智能助手 (Floating Assistant)

**功能描述**： 悬浮在界面右下角的对话框，提供自然语言指令处理。

**交互流程**：

1. **输入**：支持文本输入和语音输入（转文字）。
2. **意图识别 (NLP)**：
   - **创建指令**：
     - 用户输入：“明天下午3点提醒我给张三打电话”
     - 系统解析：
       - Action: Create Task
       - Title: 给张三打电话
       - Due Date: 明天 15:00
       - List: 默认清单 (或根据语义推断，如提到“工作”则归入工作清单)
   - **拆解指令**：
     - 用户输入：“帮我制定一个学习 Vue3 的计划”
     - 系统生成：创建一个主任务“学习 Vue3”，并利用 LLM 生成 5-10 个子任务（如“学习 Composition API”、“学习 Pinia”等）并自动挂载。
3. **反馈**：
   - Agent 回复：“已为您创建任务，并设置截止日期为 2023-12-10。”
   - 展示生成的任务卡片预览。
